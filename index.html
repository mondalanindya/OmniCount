<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OmniCount</title>
      <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Google Sans', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f0f2f5;
            color: #333;
        }
        .content {
            max-width: 1200px;
            margin: auto;
            padding: 20px;
        }


        .container {
            max-width: 1200px;
            margin: auto;
            padding: 20px;
        }
        header {
            text-align: center;
            padding: 20px 0;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .authors {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            background-color: #ffffff;
            padding-bottom: 20px;
        }

        .authors a {
            color: #007bff;
            text-decoration: none;
            margin: 0 10px;
        }

        .authors a:hover {
            text-decoration: underline;
        }
        .teaser, .leaderboards, .abstract, .viz , .method, .benchmark, .bibtex, .license {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .badges img {
            margin-right: 5px;
        }
        a {
            color: #007bff;
            text-decoration: none;
        }
        /* a:hover {
            text-decoration: underline;
        } */
        img.full-width {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-top: 20px;
        }
        .comparison-blocks {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 20px;
        }
        .image-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 250px;
        }
        .image-compare-container {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }
        .image-compare-container img, .overlay {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        .overlay {
            clip-path: inset(0 50% 0 0);
        }
        .slider {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #ffffff;
            cursor: ew-resize;
            left: 50%;
        }
        .image-caption {
            text-align: center;
            font-weight: bold;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 5px;
            border-radius: 4px;
            margin-top: 5px;
        }
        pre {
            background-color: #eee;
            border: 1px solid #999;
            border-radius: 5px;
            padding: 10px;
            white-space: pre-wrap;
            width: 80%;
            text-align: left;
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-top: 20px;
        }

        .icon-width {
            display: block;
            width: 10%; /* Adjust this value to resize the image */
            height: auto; /* This is to maintain the aspect ratio of the image */
            margin: auto; /* This will center the image */
        }
            </style>
</head>
<body>
    <header>
        <h1><img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/omnicount_icon.png" alt="OmniCount Teaser" class="icon-width"></h1>
        <div class="authors">
            <span><a href="https://mondalanindya.github.io">Anindya Mondal*<sup>125</sup></a></span>
            <span><a href="https://sauradip.github.io/">Sauradip Nag*<sup>145</sup></a></span>
            <span><a href="https://surrey-uplab.github.io/">Xiatian Zhu<sup>125</sup></a></span>
            <span><a href="https://sites.google.com/site/2adutta/">Anjan Dutta<sup>1235</sup></a></span>
        </div>
        <div class="affiliations" style="text-align: center;">
            <span style="margin-right: 10px;"><a href="https://www.surrey.ac.uk/" style="color: black;"><sup>1</sup>CVSSP,  </a></span>
            <span style="margin-right: 10px;"><a href="https://www.surrey.ac.uk/" style="color: black;"><sup>2</sup>Surrey Institute for People-centred AI,  </a></span>
            <span style="margin-right: 10px;"><a href="https://www.surrey.ac.uk/" style="color: black;"><sup>3</sup>School of Veterinary Medicine,  </a></span>
            <span style="margin-right: 10px;"><a href="https://www.surrey.ac.uk/" style="color: black;"><sup>4</sup>iFlyTek-Surrey Joint Research Center on AI </a></span>
            <span style="margin-right: 10px;"><a href="https://www.surrey.ac.uk/" style="color: black;"><sup>5</sup>University of Surrey </a></span>
        </div>
    </header>

    <div class="container">
        <div class="teaser">
            <!-- <h2 style="text-align: center;">OmniCount: Multi-Label Object Counting with Open Vocabulary</h2> -->
            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/omnicount_teaser.png" alt="OmniCount Teaser" class="full-width">
            <p style="text-align: center;">Object counting paradigms: (a) Typical single-label object counting models supports open-vocabulary counting but processes only a single category one time.
                (b) Existing multi-label object counting models are training based (i.e, not open-vocabulary) approaches and also fail to count non-atomic objects, e.g. grapes.
                (c) We advocate more efficient and convenient multi-label counting that is training-free, open-vocabulary and supports counting all the target categories in a single pass.</p>
        </div>    

        <div class="abstract">
            <h2 style="text-align: center;">Abstract</h2>
            <p>Object counting is pivotal for understanding the composition of scenes. Previously, this task was dominated by class-specific methods, which have gradually evolved into more adaptable class-agnostic strategies. However, these strategies come with their own set of limitations, such as the need for manual exemplar input and multiple passes for multiple categories, resulting in significant inefficiencies. This paper introduces a new, more practical approach enabling simultaneous counting of multiple object categories using an open vocabulary framework. Our solution, OmniCount, stands out by using semantic and geometric insights from pre-trained models to count multiple categories of objects as specified by users, all without additional training. OmniCount distinguishes itself by generating precise object masks and leveraging point prompts via the Segment Anything Model for efficient counting. To evaluate OmniCount, we created the OmniCount-191 benchmark, a first-of-its-kind dataset with multi-label object counts, including points, bounding boxes, and VQA annotations. Our comprehensive evaluation in OmniCount-191, alongside other leading benchmarks, demonstrates OmniCount's exceptional performance, significantly outpacing existing solutions and heralding a new era in object counting technology.</p>
            <div style="text-align: center;">
            <b><a href="https://arxiv.org/abs/2403.05435" class="lnk">arXiv</a></b>&nbsp;&nbsp;|&nbsp;&nbsp;<b><a href="https://arxiv.org/pdf/2403.05435.pdf" class="lnk">PDF</a></b>
            </div>
        </div>
        <div class="method">
            <h2 style="text-align: center;">Method</h2>
            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/pipeline_v2.png" alt="OmniCount Pipeline" class="full-width">
            <p style="text-align: center;">OmniCount Pipeline: Our method starts by processing the input image and their target object classes, using Semantic Estimation and Geometric Estimation modules to generate class-specific masks and depth maps. These initial priors are refined with a Semantic Refinement module for accuracy, creating precise binary masks of target objects. The refined masks help in obtaining RGB patches for each class and also extracting reference points to reduce overcounting. SAM uses these RGB patches and reference points to create instance-level masks, yielding precise object counts. &#x2744; represents frozen pre-trained models.</p>
        </div>
        <div class="viz">
            <h2 style="text-align: center;">Results</h2>
            <div class="comparison-blocks">
                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/agr/agr1.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/agr/agr1_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Potatoes: 4, Apples: 2, Bananas: 3, Onions: 4</p>
                </div>
                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/birds/birds1.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/birds/birds1_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Crow: 9, Pigeons: 10</p>
                </div>

                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/fruits/fruits1.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/fruits/fruits1_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Jackfruit: 1, Lichi: 12, Dragonfruit: 1, Pears: 27, Coconut: 3, Pineapple: 2</p>
                </div>

                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/pets/pets1.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/pets/pets1_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Dog: 1, Cats: 1, Rabbit: 1, Bird: 1, Guineapig: 1, Boar: 1</p>
                </div>

                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/urban/urban1.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/urban/urban1_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Cars: 7</p>
                </div>

                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/house/343.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/house/343_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Strawberries: 16, Kiwis: 14</p>
                </div>

                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/urban/urban3.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/urban/urban3_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Baseball field: 4</p>
                </div>

                <div class="image-block">
                    <div class="image-compare-container">
                        <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/wild/wild2.jpg" alt="Image 1A">
                        <div class="overlay">
                            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/demo/wild/wild2_mask.png" alt="Image 1B">
                        </div>
                        <div class="slider"></div>
                    </div>
                    <p class="image-caption">Elephant: 1, Buffaloes: 3</p>
                </div>

                
            </div>
        </div>
        <div class="benchmark">
            <h2 style="text-align: center;">Omnicount-191 Benchmark</h2>
            <img src="https://raw.githubusercontent.com/mondalanindya/OmniCount/main/assets/figs/omnicount191.png" alt="OmniCount-191 Benchmark" class="full-width">
            <p>OmniCount-191: A comprehensive benchmark for multi-label object counting. The dataset consists of 30,230 images with multi-label object counts, including points, bounding boxes, and VQA annotations. For more details, please visit our <a href="https://huggingface.co/datasets/anindyamondal/Omnicount-191" class="lnk">Hugging Face page</a>.</p>
        </div>
    </div>
    <div class="bibtex">
        <h2 style="text-align: center;">BibTeX</h2>
        <center><pre><code>@article{mondal2024omnicount,
            title={OmniCount: Multi-label Object Counting with Semantic-Geometric Priors},
            author={Mondal, Anindya and Nag, Sauradip and Zhu, Xiatian and Dutta, Anjan},
            journal={arXiv preprint arXiv:2403.05435},
            year={2024}
          }
        </code></pre></center>
        </div>

    <div class="license">
        <h2 style="text-align: center;">License</h2>
        <p>Object counting has legitimate commercial applications in urban planning, event logistics, and consumer behavior analysis. However, said technology concurrently facilitates human surveillance capabilities, which unscrupulous actors may intentionally or unintentionally misappropriate for nefarious purposes. As such, we must exercise reasoned skepticism towards any downstream deployment of our research that enables the monitoring of individuals without proper legal safeguards and ethical constraints. Therefore, in an effort to mitigate foreseeable misuse and uphold principles of privacy and civil liberties, we will hereby release all proprietary source code pursuant to the Open RAIL-S License, which expressly prohibits exploitative applications through robust contractual obligations and liabilities.</p>
    </div>
        <!-- <footer style="background-color: #f8f9fa; padding: 20px; font-size: 16px; line-height: 1.6; color: #333;">
            
        </footer> -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.image-compare-container').forEach(container => {
                const slider = container.querySelector('.slider');
                const overlay = container.querySelector('.overlay');
                let isDown = false;

                slider.addEventListener('mousedown', () => {
                    isDown = true;
                    slider.classList.add('active');
                    
                    document.addEventListener('mouseup', () => {
                        isDown = false;
                        slider.classList.remove('active');
                    }, { once: true });
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDown) return;
                    const rect = container.getBoundingClientRect();
                    const x = e.pageX - rect.left;
                    const walk = Math.max(0, Math.min(x, rect.width));
                    slider.style.left = `${walk}px`;
                    // overlay.style.clipPath = `inset
                    overlay.style.clipPath = `inset(0 ${rect.width - walk}px 0 0)`;
                });
            });
        });
    </script>
    <center class="noclick">  
    <a href='https://clustrmaps.com/site/1bt1g'  title='Visit tracker'><img src='//clustrmaps.com/map_v2.png?cl=ffffff&w=a&t=n&d=VUWsmjs9vT_QHmhAr6OuY_eMPD1CJyQ5FGORa626Ips&co=37a1ec&ct=ffffff'width="0.003" height="0.002"/></a>
    </center>
</body>
</html>
